<!doctype html>
<html>
    <head>
        <title>{{ username }}</title>
        <link rel="shortcut icon" href={{ url_for('static',filename='favicon.ico')}}>
        <link rel="stylesheet" type="text/css" href="/static/user.css">
        <script src="/static/d3.v3.js"></script>
        <script src="https://cdn.firebase.com/v0/firebase.js"></script>
        <script src="/static/jquery-1.10.2.min.js"></script>
    </head>
    <body>
        <script>
            var agg = new Firebase('https://{{ firebase }}.firebaseio.com/users/{{ username }}');
            var diameter = 960,
                format = d3.format(",d"),
                color = d3.scale.category20c();
            var bubble = d3.layout.pack()
                .sort(null)
                .size([diameter, diameter])
                .padding(1.5);
            var svg = d3.select("body").append("svg")
                .attr("width", diameter)
                .attr("height", diameter)
                .attr("class", "bubble");
            agg.on('value', function(snapshot) {
                if(snapshot.val() === null) {
                    alert('No data for {{ username }} exists');
                } else {
                    $("body").append('<p>{{ username }} aggregators: </p>');
                    agg.off();
                    user = snapshot.val();
                    $.each(user, function(key, value) {
                        $("body").append('<p><a href="{{ username }}/' + key + '">' + key + '</a></p>');
                    });
                }
            });
        </script>
    </body>
</html>
